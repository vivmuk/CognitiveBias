<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Art of Thinking Clearly: Comprehensive Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="cognitive-biases-data.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        
        .mode-toggle {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 0.5rem;
        }
        
        .mode-toggle.active {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            transform: scale(1.05);
        }
        
        .lesson-card {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .lesson-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        .example-box {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-left: 4px solid #ff6b6b;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        
        .detection-box {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-left: 4px solid #06b6d4;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        
        .countermeasure-box {
            background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);
            border-left: 4px solid #10b981;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        
        .quiz-section {
            display: none;
        }
        
        .quiz-section.active {
            display: block;
        }
        
        .learn-section.active {
            display: block;
        }
        
        .learn-section {
            display: none;
        }
        
        .bias-number {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            text-align: center;
            line-height: 2.5rem;
            font-weight: bold;
            margin-right: 1rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
    </div>

    <!-- Dark Mode Toggle -->
    <button class="theme-toggle tooltip" onclick="toggleTheme()" aria-label="Toggle dark mode">
        <span id="theme-icon">üåô</span>
        <span class="tooltiptext">Toggle Dark Mode</span>
    </button>

    <!-- Header -->
    <header class="bg-white shadow-md sticky top-0 z-40" style="background-color: var(--bg-secondary);">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold" style="color: var(--text-primary);">The Art of Thinking Clearly</h1>
            <nav class="flex items-center space-x-4">
                <button class="mode-toggle active" id="learn-mode-btn" onclick="switchMode('learn')">üìö Learn</button>
                <button class="mode-toggle" id="practice-mode-btn" onclick="switchMode('practice')">üß† Practice</button>
                <a href="#stats" class="hover:text-blue-600 transition" style="color: var(--text-secondary);">Stats</a>
                <a href="#search" class="hover:text-blue-600 transition" style="color: var(--text-secondary);">Search</a>
            </nav>
        </div>
    </header>

    <!-- Introduction -->
    <main class="container mx-auto px-6 py-12">
        <section class="text-center mb-16 fade-in-up">
            <h2 class="text-4xl font-extrabold mb-4" style="color: var(--text-primary);">Master the Art of Clear Thinking</h2>
            <p class="max-w-4xl mx-auto text-lg" style="color: var(--text-secondary);">
                Explore Rolf Dobelli's comprehensive guide to cognitive biases with detailed explanations, real-world examples, and practical strategies. Switch between <strong>Learn Mode</strong> for in-depth study and <strong>Practice Mode</strong> for testing your knowledge.
            </p>
        </section>

        <!-- Stats Dashboard -->
        <section id="stats" class="mb-16">
            <h3 class="text-3xl font-bold text-center mb-8" style="color: var(--text-primary);">Learning Progress</h3>
            <div class="stats-container">
                <div class="stat-card">
                    <span class="stat-number" id="completed-count">0</span>
                    <span class="stat-label">Lessons Read</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="quiz-accuracy">0%</span>
                    <span class="stat-label">Quiz Accuracy</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="total-attempts">0</span>
                    <span class="stat-label">Practice Attempts</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="learning-streak">0</span>
                    <span class="stat-label">Day Streak</span>
                </div>
            </div>
        </section>

        <!-- Search Section -->
        <section id="search" class="mb-16">
            <h3 class="text-3xl font-bold text-center mb-8" style="color: var(--text-primary);">Find a Cognitive Bias</h3>
            <div class="search-container">
                <div class="relative">
                    <span class="search-icon">üîç</span>
                    <input 
                        type="text" 
                        id="search-input" 
                        class="search-input" 
                        placeholder="Search for concepts like 'confirmation', 'anchoring', 'loss aversion'..."
                        oninput="searchBiases()"
                    >
                </div>
            </div>
            <div id="search-results" class="mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 hidden"></div>
        </section>

        <!-- Content Sections -->
        <div id="content-container">
            <!-- Learn Mode Content -->
            <div id="learn-content" class="learn-section active">
                <h3 class="text-3xl font-bold text-center mb-12" style="color: var(--text-primary);">üìö Comprehensive Lessons</h3>
                <div id="lessons-container" class="space-y-8">
                    <!-- Lessons will be generated by JavaScript -->
                </div>
            </div>

            <!-- Practice Mode Content -->
            <div id="practice-content" class="quiz-section">
                <h3 class="text-3xl font-bold text-center mb-12" style="color: var(--text-primary);">üß† Practice & Test Knowledge</h3>
                <div id="quiz-container" class="space-y-8">
                    <!-- Quizzes will be generated by JavaScript -->
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="mt-16 border-t" style="background-color: var(--bg-secondary); border-color: var(--border-color);">
        <div class="container mx-auto px-6 py-8 text-center" style="color: var(--text-secondary);">
            <p>Based on "The Art of Thinking Clearly" by Rolf Dobelli. Enhanced with comprehensive lessons and examples.</p>
            <p class="mt-2 text-sm">Progress is automatically saved. Switch between Learn and Practice modes for optimal learning.</p>
        </div>
    </footer>

<script>
// Use the comprehensive bias data from external file
const comprehensiveBiases = typeof allCognitiveBiases !== 'undefined' ? allCognitiveBiases : 
    (typeof window.cognitiveBiasesData !== 'undefined' ? window.cognitiveBiasesData : []);

// Enhanced quiz questions for practice mode
const practiceQuizzes = [
    {
        id: 1,
        title: "Survivorship Bias",
        questions: [
            {
                question: "A friend tells you about a startup that's 'the next Google.' Your first thought should be:",
                correct: "How many similar startups have failed that I'm not hearing about?",
                incorrect: [
                    "This sounds like a great investment opportunity",
                    "Successful tech companies prove this model works",
                    "I should invest before it gets too popular"
                ]
            },
            {
                question: "You see a university ad showing successful alumni. This is primarily an example of:",
                correct: "Showing only positive outcomes while hiding less successful graduates",
                incorrect: [
                    "Honest marketing showing real results",
                    "Proof that the university creates success",
                    "Statistical evidence of educational quality"
                ]
            }
        ]
    }
    // More quiz sets would continue here...
];

// App state
let currentMode = 'learn';
let userProgress = JSON.parse(localStorage.getItem('comprehensiveProgress')) || {
    lessonsRead: [],
    quizzesCompleted: [],
    totalQuizAttempts: 0,
    correctQuizAnswers: 0,
    streak: 0,
    lastVisit: new Date().toDateString()
};

// Mode switching
function switchMode(mode) {
    currentMode = mode;
    
    // Update button states
    document.getElementById('learn-mode-btn').classList.toggle('active', mode === 'learn');
    document.getElementById('practice-mode-btn').classList.toggle('active', mode === 'practice');
    
    // Show/hide content
    document.getElementById('learn-content').classList.toggle('active', mode === 'learn');
    document.getElementById('practice-content').classList.toggle('active', mode === 'practice');
    
    // Update URL without reloading
    const url = new URL(window.location);
    url.searchParams.set('mode', mode);
    window.history.pushState({}, '', url);
}

// Theme management
function toggleTheme() {
    const currentTheme = document.documentElement.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', newTheme);
    document.getElementById('theme-icon').textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
    localStorage.setItem('theme', newTheme);
}

function initTheme() {
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    document.getElementById('theme-icon').textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
}

// Search functionality
function searchBiases() {
    const query = document.getElementById('search-input').value.toLowerCase();
    const resultsContainer = document.getElementById('search-results');
    
    if (query.length < 2) {
        resultsContainer.classList.add('hidden');
        return;
    }
    
    const matches = comprehensiveBiases.filter(bias => 
        bias.title.toLowerCase().includes(query) || 
        bias.summary.toLowerCase().includes(query) ||
        bias.detailedExplanation.toLowerCase().includes(query)
    );
    
    if (matches.length === 0) {
        resultsContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No biases found matching your search.</p>';
        resultsContainer.classList.remove('hidden');
        return;
    }
    
    resultsContainer.innerHTML = matches.map(bias => {
        const isRead = userProgress.lessonsRead.includes(bias.id);
        return `
            <div class="p-4 border rounded-lg cursor-pointer hover:bg-gray-50 ${isRead ? 'border-green-300 bg-green-50' : ''}" 
                 onclick="scrollToBias(${bias.id})" 
                 style="border-color: var(--border-color); background-color: var(--bg-secondary);">
                <h4 class="font-semibold text-blue-600">${bias.id}. ${bias.title}</h4>
                <p class="text-sm text-gray-600 mt-1">${bias.summary.substring(0, 100)}...</p>
                ${isRead ? '<span class="text-xs text-green-600 font-medium">‚úì Read</span>' : ''}
            </div>
        `;
    }).join('');
    
    resultsContainer.classList.remove('hidden');
}

function scrollToBias(biasId) {
    document.getElementById(`bias-${biasId}`).scrollIntoView({ behavior: 'smooth' });
    document.getElementById('search-results').classList.add('hidden');
    document.getElementById('search-input').value = '';
}

// Generate lesson content
function generateLessons() {
    const container = document.getElementById('lessons-container');
    
    container.innerHTML = comprehensiveBiases.map(bias => `
        <div id="bias-${bias.id}" class="lesson-card">
            <div class="flex items-center mb-4">
                <span class="bias-number">${bias.id}</span>
                <div>
                    <h3 class="text-2xl font-bold" style="color: var(--text-primary);">${bias.title}</h3>
                    <p class="text-lg text-gray-600 font-medium">${bias.subtitle}</p>
                </div>
            </div>
            
            <div class="mb-6">
                <h4 class="text-lg font-semibold mb-3" style="color: var(--text-primary);">Quick Summary</h4>
                <p class="text-lg leading-relaxed" style="color: var(--text-secondary);">${bias.summary}</p>
            </div>
            
            <div class="mb-6">
                <h4 class="text-lg font-semibold mb-3" style="color: var(--text-primary);">Detailed Explanation</h4>
                <p class="leading-relaxed" style="color: var(--text-secondary);">${bias.detailedExplanation}</p>
            </div>
            
            <div class="example-box">
                <h4 class="font-semibold mb-2 text-orange-800">üìç Real-World Example</h4>
                <p class="text-orange-900">${bias.realWorldExample}</p>
            </div>
            
            <div class="detection-box">
                <h4 class="font-semibold mb-2 text-cyan-800">üîç How to Detect This Bias</h4>
                <p class="text-cyan-900">${bias.howToDetect}</p>
            </div>
            
            <div class="countermeasure-box">
                <h4 class="font-semibold mb-2 text-green-800">üõ°Ô∏è Countermeasures</h4>
                <ul class="list-disc list-inside space-y-1 text-green-900">
                    ${bias.countermeasures.map(measure => `<li>${measure}</li>`).join('')}
                </ul>
            </div>
            
            <div class="mt-6 p-4 bg-purple-50 rounded-lg border-l-4 border-purple-500">
                <h4 class="font-semibold mb-2 text-purple-800">üß† Psychology Insight</h4>
                <p class="text-purple-900">${bias.psychologyInsight}</p>
            </div>
            
            <div class="mt-6 text-center">
                <button onclick="markAsRead(${bias.id})" 
                        class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition ${userProgress.lessonsRead.includes(bias.id) ? 'bg-green-500 hover:bg-green-600' : ''}">
                    ${userProgress.lessonsRead.includes(bias.id) ? '‚úì Read' : 'Mark as Read'}
                </button>
            </div>
        </div>
    `).join('');
}

// Generate quiz content
function generateQuizzes() {
    const container = document.getElementById('quiz-container');
    
    container.innerHTML = comprehensiveBiases.map(bias => `
        <div class="lesson-card">
            <div class="flex items-center mb-6">
                <span class="bias-number">${bias.id}</span>
                <h3 class="text-2xl font-bold" style="color: var(--text-primary);">${bias.title} - Practice Quiz</h3>
            </div>
            
            <div class="mb-4">
                <h4 class="font-semibold text-lg mb-4" style="color: var(--text-primary);">Test Your Understanding:</h4>
                <p class="mb-4" style="color: var(--text-primary);">${bias.quiz.question}</p>
                <div class="space-y-3">
                    ${shuffleArray([bias.quiz.correct, ...bias.quiz.incorrect]).map(option => `
                        <button onclick="checkQuizAnswer(this, '${option}' === '${bias.quiz.correct}', ${bias.id})" 
                                class="quiz-option w-full text-left p-3 rounded-lg transition focus:outline-none focus:ring-2 focus:ring-blue-400">
                            ${option}
                        </button>
                    `).join('')}
                </div>
                <div id="quiz-explanation-${bias.id}" class="explanation mt-4" style="max-height: 0; overflow: hidden; transition: max-height 0.5s ease-in-out;">
                    <div class="p-4 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg">
                        <p><span class="font-bold text-blue-800">Correct Answer:</span> ${bias.quiz.correct}</p>
                        <p class="mt-2 text-blue-700"><span class="font-bold">Why:</span> ${bias.summary}</p>
                    </div>
                </div>
            </div>
        </div>
    `).join('');
}

// Quiz functionality
function checkQuizAnswer(button, isCorrect, biasId) {
    const parent = button.parentElement;
    const allButtons = parent.querySelectorAll('button');
    const explanationDiv = document.getElementById(`quiz-explanation-${biasId}`);

    // Disable all buttons
    allButtons.forEach(btn => {
        btn.disabled = true;
        btn.classList.remove('hover:bg-gray-200');
    });

    // Update progress
    userProgress.totalQuizAttempts++;
    if (isCorrect) {
        userProgress.correctQuizAnswers++;
        button.classList.add('bg-green-200', 'border-green-500', 'text-green-900', 'ring-2', 'ring-green-500');
        
        if (!userProgress.quizzesCompleted.includes(biasId)) {
            userProgress.quizzesCompleted.push(biasId);
        }
    } else {
        button.classList.add('bg-red-200', 'border-red-500', 'text-red-900', 'ring-2', 'ring-red-500');
    }

    // Show explanation
    explanationDiv.style.maxHeight = explanationDiv.scrollHeight + "px";
    
    saveProgress();
    updateStats();
}

// Progress tracking
function markAsRead(biasId) {
    if (!userProgress.lessonsRead.includes(biasId)) {
        userProgress.lessonsRead.push(biasId);
        saveProgress();
        updateStats();
        
        // Update button
        event.target.textContent = '‚úì Read';
        event.target.classList.remove('bg-blue-500', 'hover:bg-blue-600');
        event.target.classList.add('bg-green-500', 'hover:bg-green-600');
    }
}

function updateStats() {
    document.getElementById('completed-count').textContent = userProgress.lessonsRead.length;
    document.getElementById('quiz-accuracy').textContent = 
        userProgress.totalQuizAttempts > 0 
            ? Math.round((userProgress.correctQuizAnswers / userProgress.totalQuizAttempts) * 100) + '%'
            : '0%';
    document.getElementById('total-attempts').textContent = userProgress.totalQuizAttempts;
    
    // Update streak logic
    const today = new Date().toDateString();
    if (userProgress.lastVisit !== today) {
        const lastVisit = new Date(userProgress.lastVisit);
        const todayDate = new Date(today);
        const dayDiff = (todayDate - lastVisit) / (1000 * 60 * 60 * 24);
        
        if (dayDiff === 1) {
            userProgress.streak++;
        } else if (dayDiff > 1) {
            userProgress.streak = 1;
        }
        userProgress.lastVisit = today;
    }
    
    document.getElementById('learning-streak').textContent = userProgress.streak;
}

function saveProgress() {
    localStorage.setItem('comprehensiveProgress', JSON.stringify(userProgress));
}

// Utility functions
function shuffleArray(array) {
    const shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
}

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    initTheme();
    updateStats();
    generateLessons();
    generateQuizzes();
    
    // Check URL for mode
    const urlParams = new URLSearchParams(window.location.search);
    const mode = urlParams.get('mode') || 'learn';
    switchMode(mode);
});

</script>

</body>
</html> 