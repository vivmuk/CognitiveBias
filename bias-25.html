<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Groupthink - Cognitive Bias Learning Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="all-99-biases.js"></script>
    <script src="venice-api.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e2e8f0;
        }
        
        .main-content {
            margin-right: 140px;
        }
        
        @media (max-width: 1024px) {
            .main-content {
                margin-right: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Progress Indicator -->
    <div class="progress-indicator">
        <div class="progress-fill" id="progressFill"></div>
    </div>

    <!-- Floating Navigation -->
    <div class="floating-nav">
        <a href="#overview" class="nav-item active" onclick="scrollToSection('overview')">Overview</a>
        <a href="#details" class="nav-item" onclick="scrollToSection('details')">Details</a>
        <a href="#examples" class="nav-item" onclick="scrollToSection('examples')">Examples</a>
        <a href="#quiz" class="nav-item" onclick="scrollToSection('quiz')">Quiz</a>
        <a href="#explore" class="nav-item" onclick="scrollToSection('explore')">Explore</a>
    </div>

    <div class="container mx-auto px-4 py-8 main-content">
        <!-- Navigation Bar -->
        <div class="navigation-bar">
            <div class="flex justify-between items-center text-white">
                <a href="bias-learning-hub.html" class="flex items-center space-x-2 hover:opacity-80">
                    <span>‚Üê</span>
                    <span>Back to Hub</span>
                </a>
                <div class="flex items-center space-x-4">
                    <span class="text-sm opacity-80">Bias #25 of 99</span>
                    <div class="flex space-x-2">
                        <a href="bias-24.html" class="px-3 py-1 bg-slate-600 bg-opacity-50 rounded hover:bg-opacity-70">‚Üê Previous</a>
                        <a href="bias-26.html" class="px-3 py-1 bg-slate-600 bg-opacity-50 rounded hover:bg-opacity-70">Next ‚Üí</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Overview Section -->
        <section id="overview" class="content-card">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-white mb-4">Groupthink</h1>
                <p class="text-xl text-slate-300 italic mb-6">Why Groups Make Bad Decisions</p>
                <div class="flex justify-center items-center space-x-4 mb-6">
                    <span class="px-3 py-1 bg-red-500 text-white rounded-full text-sm font-medium">Advanced</span>
                    <span class="px-3 py-1 bg-pink-500 text-white rounded-full text-sm font-medium">social</span>
                    <span class="px-3 py-1 bg-gray-500 text-white rounded-full text-sm font-medium">Chapter 25</span>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-2xl font-bold text-white mb-4">What is it?</h3>
                    <p class="text-slate-300 leading-relaxed mb-6">Groups often make worse decisions than individuals because members suppress dissent, fail to critically analyze alternatives, and seek conformity over accuracy.</p>
                    
                    <h3 class="text-2xl font-bold text-white mb-4">Why it matters</h3>
                    <p class="text-slate-300 leading-relaxed">When group harmony becomes more important than reaching the right decision, groupthink sets in. Members self-censor, pressure dissenters, and create an illusion of unanimity that prevents good decision-making.</p>
                </div>
                
                <div class="bg-gradient-to-br from-indigo-500/20 to-purple-500/20 p-6 rounded-lg border border-indigo-500/30">
                    <h3 class="text-xl font-bold text-white mb-4">Key Insight</h3>
                    <blockquote class="text-lg text-slate-200 italic border-l-4 border-indigo-500 pl-4">
                        "The Bay of Pigs invasion failed partly due to groupthink."
                    </blockquote>
                </div>
            </div>
        </section>

        <!-- Detailed Explanation Section -->
        <section id="details" class="content-card">
            <h2 class="text-3xl font-bold text-white mb-6">How Groupthink Works</h2>
            
            <div class="space-y-6">
                <div class="bg-orange-500/20 border-l-4 border-orange-500 p-6 rounded-r-lg">
                    <h3 class="text-xl font-bold text-orange-300 mb-3">The Mechanism</h3>
                    <p class="text-slate-300">When group harmony becomes more important than reaching the right decision, groupthink sets in. Members self-censor, pressure dissenters, and create an illusion of unanimity that prevents good decision-making.</p>
                </div>
                
                <div class="bg-cyan-500/20 border-l-4 border-cyan-500 p-6 rounded-r-lg">
                    <h3 class="text-xl font-bold text-cyan-300 mb-3">How to Detect It</h3>
                    <p class="text-slate-300 mb-3">Notice when groups seem too harmonious, when dissent is discouraged, or when alternative viewpoints aren't seriously considered. Be wary of groups that seem to have unanimous agreement on complex issues.</p>
                </div>
                
                <div class="bg-green-500/20 border-l-4 border-green-500 p-6 rounded-r-lg">
                    <h3 class="text-xl font-bold text-green-300 mb-3">Countermeasures</h3>
                    <ul class="list-disc list-inside text-slate-300 space-y-2">
                        <li>Encourage devil's advocate roles in group discussions</li><li>Actively seek outside opinions and expert input</li><li>Reward people for raising concerns and alternative viewpoints</li><li>Make it safe for group members to express dissent</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Real-World Examples Section -->
        <section id="examples" class="content-card">
            <h2 class="text-3xl font-bold text-white mb-6">Real-World Example</h2>
            
            <div class="bg-blue-500/20 p-6 rounded-lg border border-blue-500/30">
                <h3 class="text-xl font-bold text-blue-300 mb-3">üìù Case Study</h3>
                <p class="text-slate-300">The Bay of Pigs invasion failed partly due to groupthink. Kennedy's advisors suppressed doubts to maintain group cohesion, failed to seek outside opinions, and created an illusion that everyone supported the plan. Critical analysis was sacrificed for group harmony.</p>
            </div>
        </section>

        <!-- Quiz Section -->
        <section id="quiz" class="quiz-container">
            <h2 class="text-3xl font-bold mb-6">Test Your Understanding</h2>
            
            <div id="quizContent">
                <div class="mb-6">
                    <h3 class="text-xl font-bold mb-4">Your team unanimously agrees on a risky strategy without much debate. This might indicate:</h3>
                    
                    <div class="space-y-3">
                        <button class="quiz-option w-full text-left" onclick="selectAnswer(this, false)">Excellent team cohesion and alignment</button>
                        <button class="quiz-option w-full text-left" onclick="selectAnswer(this, false)">A clearly optimal strategy that everyone recognizes</button>
                        <button class="quiz-option w-full text-left" onclick="selectAnswer(this, false)">Strong leadership that has convinced everyone of the best path</button>
                        <button class="quiz-option w-full text-left" onclick="selectAnswer(this, true)">Groupthink - you should encourage dissent and seek outside perspectives</button>
                    </div>
                </div>
                
                <div id="quizResult" class="hidden mt-6 p-4 rounded-lg border-2 border-white border-opacity-30 bg-slate-700/50">
                    <div id="resultText"></div>
                    <button onclick="completeLesson()" 
                            class="mt-4 px-6 py-3 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition-colors">
                        Mark as Complete & Continue
                    </button>
                </div>
            </div>
        </section>

        <!-- Deep Exploration Section -->
        <section id="explore" class="deep-dive-section">
            <h2 class="text-3xl font-bold mb-6">Explore Deeper with AI</h2>
            <p class="text-lg mb-6 opacity-90">
                Use AI to explore this bias from different perspectives and get personalized insights.
            </p>
            
            <!-- Exploration Categories -->
            <div class="mb-6">
                <h3 class="text-xl font-bold mb-4">Choose an exploration focus:</h3>
                <div class="flex flex-wrap">
                    <button class="exploration-button" onclick="exploreCategory('business')">
                        üè¢ Business Impact
                    </button>
                    <button class="exploration-button" onclick="exploreCategory('personal')">
                        üë§ Personal Life
                    </button>
                    <button class="exploration-button" onclick="exploreCategory('scientific')">
                        üî¨ Scientific Research
                    </button>
                    <button class="exploration-button" onclick="exploreCategory('historical')">
                        üìö Historical Examples
                    </button>
                    <button class="exploration-button" onclick="exploreCategory('general')">
                        üß† Deep Psychology
                    </button>
                </div>
            </div>
            
            <!-- Custom Prompt Area -->
            <div class="mb-6">
                <h3 class="text-xl font-bold mb-4">Or ask your own question:</h3>
                <textarea class="custom-prompt-area" placeholder="Ask anything about Groupthink..." id="customPrompt"></textarea>
                <button onclick="exploreCustom()" class="exploration-button">
                    üí¨ Get AI Insights
                </button>
            </div>
            
            <!-- Suggested Questions -->
            <div class="mb-6">
                <h3 class="text-xl font-bold mb-4">Quick questions to explore:</h3>
                <div class="space-y-2" id="suggestedQuestions">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- AI Response Area -->
            <div id="aiResponse" class="hidden">
                <h3 class="text-xl font-bold mb-4 text-indigo-300">ü§ñ AI Insights:</h3>
                <div id="responseContent" class="ai-response-viewer">
                    <!-- AI response will be inserted here -->
                </div>
            </div>
            
            <!-- Loading State -->
            <div id="loadingState" class="hidden text-center py-8">
                <div class="loading-spinner mx-auto mb-4"></div>
                <p class="text-lg">Generating deep insights...</p>
            </div>
        </section>
    </div>

    <script>
        // Initialize Venice API
        const veniceAPI = new VeniceAPIService();
        let currentBias = null;
        
        // Load bias data
        document.addEventListener('DOMContentLoaded', function() {
            currentBias = {
                id: 25,
                title: "Groupthink",
                summary: "Groups often make worse decisions than individuals because members suppress dissent, fail to critically analyze alternatives, and seek conformity over accuracy."
            };
            
            loadSuggestedQuestions();
            updateProgress();
        });

        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
            
            // Update active nav item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[href="#${sectionId}"]`).classList.add('active');
        }

        function updateProgress() {
            const scrollPosition = window.scrollY;
            const windowHeight = window.innerHeight;
            const documentHeight = document.documentElement.scrollHeight;
            
            const progress = (scrollPosition / (documentHeight - windowHeight)) * 100;
            document.getElementById('progressFill').style.width = `${Math.min(progress, 100)}%`;
        }

        function selectAnswer(button, isCorrect) {
            // Disable all options
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.disabled = true;
                option.style.cursor = 'default';
            });
            
            // Style the selected answer
            if (isCorrect) {
                button.style.background = 'rgba(34, 197, 94, 0.8)';
                button.style.borderColor = 'rgb(34, 197, 94)';
            } else {
                button.style.background = 'rgba(239, 68, 68, 0.8)';
                button.style.borderColor = 'rgb(239, 68, 68)';
                
                // Highlight the correct answer
                document.querySelectorAll('.quiz-option').forEach(option => {
                    if (option.onclick.toString().includes('true')) {
                        option.style.background = 'rgba(34, 197, 94, 0.8)';
                        option.style.borderColor = 'rgb(34, 197, 94)';
                    }
                });
            }
            
            // Show result
            const resultDiv = document.getElementById('quizResult');
            const resultText = document.getElementById('resultText');
            
            if (isCorrect) {
                resultText.innerHTML = `
                    <h4 class="font-bold text-green-300 mb-2 text-lg">üéâ Correct!</h4>
                    <p class="text-slate-200">Great! You've understood the key concept behind Groupthink.</p>
                `;
            } else {
                resultText.innerHTML = `
                    <h4 class="font-bold text-red-300 mb-2 text-lg">Not quite right.</h4>
                    <p class="text-slate-200">Review the explanation above to better understand Groupthink.</p>
                `;
            }
            
            resultDiv.classList.remove('hidden');
            
            // Save quiz score
            const score = isCorrect ? 100 : 0;
            let quizScores = JSON.parse(localStorage.getItem('quizScores') || '{}');
            quizScores[25] = score;
            localStorage.setItem('quizScores', JSON.stringify(quizScores));
        }

        function completeLesson() {
            // Mark as completed
            let progressData = JSON.parse(localStorage.getItem('biasProgress') || '{}');
            progressData[25] = 'completed';
            localStorage.setItem('biasProgress', JSON.stringify(progressData));
            
            // Show completion message
            alert('üéâ Congratulations! You\'ve completed Groupthink. Your progress has been saved.');
            
            // Optionally navigate to next bias or back to hub
            if (confirm('Would you like to continue to the next bias?')) {
                window.location.href = 'bias-1.html';
            } else {
                window.location.href = 'bias-learning-hub.html';
            }
        }

        function loadSuggestedQuestions() {
            const questions = veniceAPI.getSuggestedQuestions('Groupthink');
            const container = document.getElementById('suggestedQuestions');
            
            questions.forEach(question => {
                const button = document.createElement('button');
                button.className = 'exploration-button text-sm';
                button.textContent = question;
                button.onclick = () => exploreQuestion(question);
                container.appendChild(button);
            });
        }

        async function exploreCategory(category) {
            showLoading();
            
            // Update active button
            document.querySelectorAll('.exploration-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            try {
                const response = await veniceAPI.generateDeepExploration(
                    currentBias.title,
                    currentBias.summary,
                    category
                );
                showAIResponse(response);
            } catch (error) {
                showAIResponse("I apologize, but I'm having trouble connecting to the AI service right now. Please try again later.");
            }
        }

        async function exploreCustom() {
            const customPrompt = document.getElementById('customPrompt').value.trim();
            if (!customPrompt) {
                alert('Please enter a question or topic you\'d like to explore.');
                return;
            }
            
            showLoading();
            
            try {
                const response = await veniceAPI.generateCustomPrompt(
                    currentBias.title,
                    currentBias.summary,
                    customPrompt
                );
                showAIResponse(response);
            } catch (error) {
                showAIResponse("I apologize, but I'm having trouble connecting to the AI service right now. Please try again later.");
            }
        }

        async function exploreQuestion(question) {
            showLoading();
            
            try {
                const response = await veniceAPI.generateCustomPrompt(
                    currentBias.title,
                    currentBias.summary,
                    question
                );
                showAIResponse(response);
            } catch (error) {
                showAIResponse("I apologize, but I'm having trouble connecting to the AI service right now. Please try again later.");
            }
        }

        function showLoading() {
            document.getElementById('loadingState').classList.remove('hidden');
            document.getElementById('aiResponse').classList.add('hidden');
        }

        function showAIResponse(content) {
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('responseContent').innerHTML = formatAIResponse(content);
            document.getElementById('aiResponse').classList.remove('hidden');
            
            // Scroll to response
            document.getElementById('aiResponse').scrollIntoView({ behavior: 'smooth' });
        }

        function formatAIResponse(content) {
            // Enhanced markdown-like formatting for better readability
            let formatted = content
                // Handle headers
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^# (.*$)/gim, '<h1>$1</h1>')
                // Handle bold and italic
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                // Handle lists
                .replace(/^\d+\.\s+(.*$)/gim, '<li>$1</li>')
                .replace(/^[-*]\s+(.*$)/gim, '<li>$1</li>')
                // Handle paragraphs
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');
            
            // Wrap in paragraphs and fix lists
            formatted = '<p>' + formatted + '</p>';
            formatted = formatted.replace(/(<li>.*?<\/li>)/gs, (match) => {
                const listItems = match.match(/<li>.*?<\/li>/g);
                return '<ul>' + listItems.join('') + '</ul>';
            });
            
            // Clean up extra paragraph tags
            formatted = formatted.replace(/<p><\/p>/g, '');
            formatted = formatted.replace(/<p>(<h[1-6]>)/g, '$1');
            formatted = formatted.replace(/(<\/h[1-6]>)<\/p>/g, '$1');
            formatted = formatted.replace(/<p>(<ul>)/g, '$1');
            formatted = formatted.replace(/(<\/ul>)<\/p>/g, '$1');
            
            return formatted;
        }

        // Scroll progress tracking
        window.addEventListener('scroll', updateProgress);
        
        // Initialize progress
        updateProgress();
    </script>
</body>
</html>